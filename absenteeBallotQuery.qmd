---
title: "absenteeBallots"
author: "Josue Sanchez Hernandez"
format: pdf
editor: visual
---

```{r}
#| label: setup
#| include: false

library(tidyr)
library(httr)
library(rvest)
library(readxl)
library(polite)
library(XML)
```

## Reading in Data

```{r}
# Assigning the URL of the Ohio elections website to an object
url <- "https://www.ohiosos.gov/elections/voters/about-this-election/2023-general-absenteereport/"

# Sending GET request to get webpage contents
webpage <- GET(url, add_headers('user-agent' = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36'))

# Extracting links to all .xlsx files on the website
xlsx_links <- webpage |>
  read_html() |>
  html_node('.xlsx') |>
  html_text()
```

```{r}
customUserAgent <- "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3"
webpage2 <- read_html(url, user_agent(customUserAgent))
```
